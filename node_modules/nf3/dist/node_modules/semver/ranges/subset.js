"use strict";const Range=require(`../classes/range.js`),Comparator=require(`../classes/comparator.js`),{ANY}=Comparator,satisfies=require(`../functions/satisfies.js`),compare=require(`../functions/compare.js`),subset=(t,n,r={})=>{if(t===n)return!0;t=new Range(t,r),n=new Range(n,r);let i=!1;OUTER:for(let e of t.set){for(let t of n.set){let n=simpleSubset(e,t,r);if(i||=n!==null,n)continue OUTER}if(i)return!1}return!0},minimumVersionWithPreRelease=[new Comparator(`>=0.0.0-0`)],minimumVersion=[new Comparator(`>=0.0.0`)],simpleSubset=(e,t,a)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===ANY){if(t.length===1&&t[0].semver===ANY)return!0;e=a.includePrerelease?minimumVersionWithPreRelease:minimumVersion}if(t.length===1&&t[0].semver===ANY){if(a.includePrerelease)return!0;t=minimumVersion}let o=new Set,s,c;for(let t of e)t.operator===`>`||t.operator===`>=`?s=higherGT(s,t,a):t.operator===`<`||t.operator===`<=`?c=lowerLT(c,t,a):o.add(t.semver);if(o.size>1)return null;let l;if(s&&c&&(l=compare(s.semver,c.semver,a),l>0||l===0&&(s.operator!==`>=`||c.operator!==`<=`)))return null;for(let e of o){if(s&&!satisfies(e,String(s),a)||c&&!satisfies(e,String(c),a))return null;for(let n of t)if(!satisfies(e,String(n),a))return!1;return!0}let u,d,f,p,m=c&&!a.includePrerelease&&c.semver.prerelease.length?c.semver:!1,h=s&&!a.includePrerelease&&s.semver.prerelease.length?s.semver:!1;m&&m.prerelease.length===1&&c.operator===`<`&&m.prerelease[0]===0&&(m=!1);for(let e of t){if(p=p||e.operator===`>`||e.operator===`>=`,f=f||e.operator===`<`||e.operator===`<=`,s){if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),e.operator===`>`||e.operator===`>=`){if(u=higherGT(s,e,a),u===e&&u!==s)return!1}else if(s.operator===`>=`&&!satisfies(s.semver,String(e),a))return!1}if(c){if(m&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===m.major&&e.semver.minor===m.minor&&e.semver.patch===m.patch&&(m=!1),e.operator===`<`||e.operator===`<=`){if(d=lowerLT(c,e,a),d===e&&d!==c)return!1}else if(c.operator===`<=`&&!satisfies(c.semver,String(e),a))return!1}if(!e.operator&&(c||s)&&l!==0)return!1}return!(s&&f&&!c&&l!==0||c&&p&&!s&&l!==0||h||m)},higherGT=(e,t,n)=>{if(!e)return t;let r=compare(e.semver,t.semver,n);return r>0?e:r<0||t.operator===`>`&&e.operator===`>=`?t:e},lowerLT=(e,t,n)=>{if(!e)return t;let r=compare(e.semver,t.semver,n);return r<0?e:r>0||t.operator===`<`&&e.operator===`<=`?t:e};module.exports=subset;