"use strict";Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Ignore=void 0;const minimatch_1=require(`minimatch`),pattern_js_1=require(`./pattern.js`),defaultPlatform=typeof process==`object`&&process&&typeof process.platform==`string`?process.platform:`linux`;class Ignore{relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(e,{nobrace:t,nocase:r,noext:i,noglobstar:a,platform:o=defaultPlatform}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=o,this.mmopts={dot:!0,nobrace:t,nocase:r,noext:i,noglobstar:a,optimizationLevel:2,platform:o,nocomment:!0,nonegate:!0};for(let t of e)this.add(t)}add(n){let r=new minimatch_1.Minimatch(n,this.mmopts);for(let n=0;n<r.set.length;n++){let i=r.set[n],a=r.globParts[n];if(!i||!a)throw Error(`invalid pattern object`);for(;i[0]===`.`&&a[0]===`.`;)i.shift(),a.shift();let o=new pattern_js_1.Pattern(i,a,0,this.platform),s=new minimatch_1.Minimatch(o.globString(),this.mmopts),c=a[a.length-1]===`**`,l=o.isAbsolute();l?this.absolute.push(s):this.relative.push(s),c&&(l?this.absoluteChildren.push(s):this.relativeChildren.push(s))}}ignored(e){let t=e.fullpath(),n=`${t}/`,r=e.relative()||`.`,i=`${r}/`;for(let e of this.relative)if(e.match(r)||e.match(i))return!0;for(let e of this.absolute)if(e.match(t)||e.match(n))return!0;return!1}childrenIgnored(e){let t=e.fullpath()+`/`,n=(e.relative()||`.`)+`/`;for(let e of this.relativeChildren)if(e.match(n))return!0;for(let e of this.absoluteChildren)if(e.match(t))return!0;return!1}}exports.Ignore=Ignore;