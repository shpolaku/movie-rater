"use strict";const scan=require(`./scan`),parse=require(`./parse`),utils=require(`./utils`),constants=require(`./constants`),isObject=e=>e&&typeof e==`object`&&!Array.isArray(e),picomatch=(e,t,n=!1)=>{if(Array.isArray(e)){let r=e.map(e=>picomatch(e,t,n));return e=>{for(let t of r){let n=t(e);if(n)return n}return!1}}let r=isObject(e)&&e.tokens&&e.input;if(e===``||typeof e!=`string`&&!r)throw TypeError(`Expected pattern to be a non-empty string`);let a=t||{},o=a.windows,s=r?picomatch.compileRe(e,t):picomatch.makeRe(e,t,!1,!0),c=s.state;delete s.state;let l=()=>!1;if(a.ignore){let e={...t,ignore:null,onMatch:null,onResult:null};l=picomatch(a.ignore,e,n)}let u=(n,r=!1)=>{let{isMatch:i,match:u,output:d}=picomatch.test(n,s,t,{glob:e,posix:o}),f={glob:e,state:c,regex:s,posix:o,input:n,output:d,match:u,isMatch:i};return typeof a.onResult==`function`&&a.onResult(f),i===!1?(f.isMatch=!1,r?f:!1):l(n)?(typeof a.onIgnore==`function`&&a.onIgnore(f),f.isMatch=!1,r?f:!1):(typeof a.onMatch==`function`&&a.onMatch(f),r?f:!0)};return n&&(u.state=c),u};picomatch.test=(e,t,r,{glob:i,posix:a}={})=>{if(typeof e!=`string`)throw TypeError(`Expected input to be a string`);if(e===``)return{isMatch:!1,output:``};let o=r||{},s=o.format||(a?utils.toPosixSlashes:null),c=e===i,l=c&&s?s(e):e;return c===!1&&(l=s?s(e):e,c=l===i),(c===!1||o.capture===!0)&&(c=o.matchBase===!0||o.basename===!0?picomatch.matchBase(e,t,r,a):t.exec(l)),{isMatch:!!c,match:c,output:l}},picomatch.matchBase=(e,t,r)=>(t instanceof RegExp?t:picomatch.makeRe(t,r)).test(utils.basename(e)),picomatch.isMatch=(e,t,n)=>picomatch(t,n)(e),picomatch.parse=(e,n)=>Array.isArray(e)?e.map(e=>picomatch.parse(e,n)):parse(e,{...n,fastpaths:!1}),picomatch.scan=(t,n)=>scan(t,n),picomatch.compileRe=(e,t,n=!1,r=!1)=>{if(n===!0)return e.output;let i=t||{},a=i.contains?``:`^`,o=i.contains?``:`$`,s=`${a}(?:${e.output})${o}`;e&&e.negated===!0&&(s=`^(?!${s}).*$`);let c=picomatch.toRegex(s,t);return r===!0&&(c.state=e),c},picomatch.makeRe=(e,n={},r=!1,i=!1)=>{if(!e||typeof e!=`string`)throw TypeError(`Expected a non-empty string`);let a={negated:!1,fastpaths:!0};return n.fastpaths!==!1&&(e[0]===`.`||e[0]===`*`)&&(a.output=parse.fastpaths(e,n)),a.output||(a=parse(e,n)),picomatch.compileRe(a,n,r,i)},picomatch.toRegex=(e,t)=>{try{let n=t||{};return new RegExp(e,n.flags||(n.nocase?`i`:``))}catch(e){if(t&&t.debug===!0)throw e;return/$^/}},picomatch.constants=constants,module.exports=picomatch;