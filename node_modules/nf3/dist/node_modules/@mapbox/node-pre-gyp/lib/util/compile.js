"use strict";module.exports=exports;const fs=require(`fs`),path=require(`path`),win=process.platform===`win32`,existsSync=fs.existsSync||path.existsSync,cp=require(`child_process`);function which_node_gyp(){let e;if(process.env.npm_config_node_gyp)try{if(e=process.env.npm_config_node_gyp,existsSync(e))return e}catch{}try{let n=require.resolve(`node-gyp`);if(e=path.join(path.dirname(path.dirname(n)),`bin/node-gyp.js`),existsSync(e))return e}catch{}if(process.execPath.indexOf(`iojs`)===-1)try{let n=require.resolve(`npm`);if(e=path.join(path.dirname(path.dirname(n)),`node_modules/node-gyp/bin/node-gyp.js`),existsSync(e))return e}catch{}let n=path.join(path.dirname(path.dirname(process.execPath)),`lib/node_modules/npm/`);if(e=path.join(n,`node_modules/node-gyp/bin/node-gyp.js`),existsSync(e))return e}module.exports.run_gyp=function(e,t,r){let i=``,a=[];if(t.runtime&&t.runtime===`node-webkit`)i=`nw-gyp`,win&&(i+=`.cmd`);else{let e=which_node_gyp();e?(i=process.execPath,a.push(e)):(i=`node-gyp`,win&&(i+=`.cmd`))}let o=a.concat(e),s=cp.spawn(i,o,{cwd:void 0,env:process.env,stdio:[0,1,2]});s.on(`error`,e=>{if(e)return r(Error(`Failed to execute '`+i+` `+o.join(` `)+`' (`+e+`)`));r(null,t)}),s.on(`close`,e=>{if(e&&e!==0)return r(Error(`Failed to execute '`+i+` `+o.join(` `)+`' (`+e+`)`));r(null,t)})};